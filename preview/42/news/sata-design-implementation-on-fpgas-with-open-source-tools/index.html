<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=5">
<link href=/preview/42/vendor/bootstrap/bootstrap.min.css rel=stylesheet>
<link href=/preview/42/vendor/phosphor-icons/css/phosphor.css rel=stylesheet>
<link href=/preview/42/vendor/magnific-popup/magnific-popup.css rel=stylesheet>
<link rel=stylesheet href=/preview/42/scss/theme.min.ca8f03dc6b79df7a68780569c1f9b8b26f79d12f8d27997ab2e9ca6b8fcd589d.css>
<link rel=icon href=/preview/42/images/favicon/cropped-favicon-1-32x32.png sizes=32x32>
<link rel=icon href=/preview/42/images/favicon/cropped-favicon-1-192x192.png sizes=192x192>
<link rel=apple-touch-icon href=/preview/42/images/favicon/cropped-favicon-1-180x180.png>
<meta name=msapplication-TileImage content="/preview/42/images/favicon/cropped-favicon-1-270x270.png">
<script src=https://cmp.osano.com/16A0DbT9yDNIaQkvZ/3b49aaa9-15ab-4d47-a8fb-96cc25b5543c/osano.js></script>
<title>SATA Design Implementation on FPGAs with Open Source Tools | CHIPS Alliance</title>
<meta name=description content="This post was originally published at Antmicro.
Real-world FPGAs designs often require high rate transmission protocols such as PCIe, USB and SATA …">
<meta property="og:title" content="SATA Design Implementation on FPGAs with Open Source Tools">
<meta property="og:description" content="This post was originally published at Antmicro.
Real-world FPGAs designs often require high rate transmission protocols such as PCIe, USB and SATA which rely on high speed transceivers for external communication. These protocols are used to interface with various devices such as graphics cards and storage devices, and many of our clients reach out to us specifically because they need the flexibility, high-throughput and low-latency characteristics of FPGAs.
In particular, for customers that deal with high data volumes (which is very common in video applications), implementing SATA to communicate and transfer data with e.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://chipsalliance.org/preview/42/news/sata-design-implementation-on-fpgas-with-open-source-tools/"><meta property="og:image" content="https://chipsalliance.org/preview/42/news/sata-design-implementation-on-fpgas-with-open-source-tools/share.png"><meta property="article:section" content="news">
<meta property="article:published_time" content="2022-01-05T00:00:00+00:00">
<meta property="article:modified_time" content="2022-01-05T00:00:00+00:00"><meta property="og:site_name" content="CHIPS Alliance">
<meta itemprop=name content="SATA Design Implementation on FPGAs with Open Source Tools">
<meta itemprop=description content="This post was originally published at Antmicro.
Real-world FPGAs designs often require high rate transmission protocols such as PCIe, USB and SATA which rely on high speed transceivers for external communication. These protocols are used to interface with various devices such as graphics cards and storage devices, and many of our clients reach out to us specifically because they need the flexibility, high-throughput and low-latency characteristics of FPGAs.
In particular, for customers that deal with high data volumes (which is very common in video applications), implementing SATA to communicate and transfer data with e."><meta itemprop=datePublished content="2022-01-05T00:00:00+00:00">
<meta itemprop=dateModified content="2022-01-05T00:00:00+00:00">
<meta itemprop=wordCount content="991"><meta itemprop=image content="https://chipsalliance.org/preview/42/news/sata-design-implementation-on-fpgas-with-open-source-tools/share.png">
<meta itemprop=keywords content><meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://chipsalliance.org/preview/42/news/sata-design-implementation-on-fpgas-with-open-source-tools/share.png">
<meta name=twitter:title content="SATA Design Implementation on FPGAs with Open Source Tools">
<meta name=twitter:description content="This post was originally published at Antmicro.
Real-world FPGAs designs often require high rate transmission protocols such as PCIe, USB and SATA which rely on high speed transceivers for external communication. These protocols are used to interface with various devices such as graphics cards and storage devices, and many of our clients reach out to us specifically because they need the flexibility, high-throughput and low-latency characteristics of FPGAs.
In particular, for customers that deal with high data volumes (which is very common in video applications), implementing SATA to communicate and transfer data with e.">
<meta name=twitter:site content="@chipsalliance">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-H0KF2YZTR7"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-H0KF2YZTR7')</script>
</head>
<body>
<header>
<div class="lfprojects position-fixed">
<a href=https://www.linuxfoundation.org/projects target=_blank rel="noopener noreferrer"><img src=/preview/42/images/lf-projects-banner-white.svg></a>
</div>
<nav class="navbar navbar-expand-lg position-fixed w-100 zindex-dropdown" id=mainnavigationBar>
<a class=navbar-brand href=/preview/42/>
<img src=/preview/42/images/chips_alliance.svg alt=Nav-Logo>
</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-default><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><line x1="3.5" y1="5.5" x2="21.5" y2="5.5" stroke="#292d32" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/><line x1="4.5" y1="12.5" x2="21.5" y2="12.5" stroke="#292d32" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/><line x1="11.5" y1="19.5" x2="21.5" y2="19.5" stroke="#292d32" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/></svg>
</span>
<span class=navbar-toggler-toggled><svg width="20" height="20" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21.5 6.5l-15 15" stroke="#404152" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/><path d="M21.5 21.5l-15-15" stroke="#404152" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/></svg>
</span>
</button>
<div class="collapse navbar-collapse" id=navbarSupportedContent>
<ul class="navbar-nav mx-auto mb-20 mb-lg-0 navbar-nav-scroll">
<li class="nav-item dropdown">
<div class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true aria-expanded=false>
About
</div>
<div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink>
<a class=dropdown-item href=/preview/42/about/who-we-are/>Who We Are</a>
<a class=dropdown-item href=/preview/42/about/members/>Members</a>
<a class=dropdown-item href=/preview/42/about/governance/>Governance</a>
<a class=dropdown-item href=/preview/42/about/faq/>FAQ</a>
<a class=dropdown-item href=/preview/42/about/contact/>Contact</a>
</div>
</li>
<li class=nav-item>
<a class=nav-link href=/preview/42/projects/>
Projects
</a>
</li>
<li class=nav-item>
<a class=nav-link href=/preview/42/events/>
Events
</a>
</li>
<li class=nav-item>
<a class=nav-link href=/preview/42/workgroups/>
Workgroups
</a>
</li>
<li class="nav-item dropdown">
<div class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true aria-expanded=false>
News
</div>
<div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink>
<a class=dropdown-item href=/preview/42/categories/announcements/>Announcements</a>
<a class=dropdown-item href=/preview/42/categories/blog/>Blog</a>
<a class=dropdown-item href=/preview/42/categories/reports/>Reports</a>
</div>
</li>
<li class=nav-item>
<a class=nav-link href=/preview/42/join/>
Join
</a>
</li>
</ul>
</div>
<div class="d-none d-lg-block">
<div class=nav-item>
<a href=/preview/42/getting-started/ class="btn btn-sm btn-primary">Get Started</a>
</div>
</div>
</nav>
</header>
<section class=blog-details>
<div class=container>
<div class=row>
<div class=col-lg-12>
<article class=blog-single>
<div class=inner-blog-details>
<h1>SATA Design Implementation on FPGAs with Open Source Tools</h1>
<div class=inner-blog-details-meta>
<ul class=list-unstyled>
<li class=list-inline-item>
<p>January 5, 2022</p>
</li>
<li class=list-inline-item>
<p>5 <span>minutes</span></p>
</li>
<li class=list-inline-item>
<p>991 <span>words</span></p>
</li>
</ul>
</div>
</div>
<div class="rounded-box mb-xxl-11 mb-8">
<img src=https://chipsalliance.org/preview/42/news/sata-design-implementation-on-fpgas-with-open-source-tools/share.png class=w-100 alt=featured-image>
</div>
<div><p><em>This post was originally published at <a href=https://antmicro.com/blog/2021/12/sata-with-open-source-fpga-tools/>Antmicro</a>.</em></p>
<p>Real-world FPGAs designs often require high rate transmission protocols such as PCIe, USB and SATA which rely on high speed transceivers for external communication. These protocols are used to interface with various devices such as graphics cards and storage devices, and many of our clients reach out to us specifically because they need the <a href=https://antmicro.com/technologies/fpga/>flexibility, high-throughput and low-latency characteristics of FPGAs</a>.</p>
<p>In particular, for customers that deal with high data volumes (which is very common in video applications), implementing SATA to communicate and transfer data with e.g. an SSD hard drive is a must.</p>
<p>Since Antmicro believes in an open source, vendor neutral approach to FPGAs, today we will describe how to build a SATA-enabled system using a completely open source flow, including the hardware platform, FPGA IP as well as, perhaps most importantly, tooling which we have been developing as part our bigger effort within CHIPS Alliance.</p>
<h2 id=origin-and-motivation>Origin and motivation</h2>
<p>Antmicro is a pioneer in a software-driven approach to developing FPGAs. On top of new hardware description languages, open source IP and software that have been gaining traction in the FPGA space, one necessary missing element has been open source tooling. Open tools allow a workflow more familiar to software developers, who are used to just downloading their toolchain without having to log in anywhere or managing licenses.</p>
<p>Moreover, open tools provide the great advantage of easy to set up CI systems that keep track of regressions and allow more efficient and robust development.</p>
<p>Some of our forward-looking customers such as Google require these kinds of workflows to take full control of their development toolchain, for various reasons: <a href=https://opensource.googleblog.com/2021/11/Open%20source%20DDR%20controller%20framework%20for%20mitigating%20Rowhammer.html>security</a>, <a href=https://antmicro.com/blog/2021/09/cfu-support-in-renode/>development productivity</a>, <a href=https://antmicro.com/blog/2021/08/open-source-github-actions-runners-with-gcp-and-terraform/>scale</a>. Others, like QuickLogic, who thanks to the cooperation with us are the <a href=https://antmicro.com/blog/2020/06/quicklogic-open-reconfigurable-computing-press-release/>first ever FPGA vendor company to fully embrace open source tools</a>, are looking to deliver a more tailored experience to their own customers, which is easier to do based on open source.</p>
<p>To prove the viability of open source FPGA tools, being able to implement high-speed interfaces to verify how the toolchain handles high-speed transceivers is key; thus, a fully open source SATA is a very good target, especially that an open source core, <a href=https://github.com/enjoy-digital/litesata>LiteSATA</a>, was available in our favorite open source SoC generator for FPGAs, <a href=https://github.com/enjoy-digital/litex>LiteX</a>. What was missing was a hardware platform, putting it all together, and – of course – tools.</p>
<h2 id=hardware-setup>Hardware setup</h2>
<p>The SATA design we developed is meant to run on top of a <a href=https://digilent.com/reference/programmable-logic/nexys-video/start>Nexys Video</a> board from Digilent, featuring an Artix7 200T Xilinx FPGA, coupled with custom expansion board connected through the <a href=https://en.wikipedia.org/wiki/FPGA_Mezzanine_Card>FMC connector</a> and hosting an M.2 SSD module. Thanks to the FMC connector on the Nexys Video we achieved a relatively simple and modular hardware setup.</p>
<p>The FMC expansion board, developed by Antmicro, is fully open-sourced and available on <a href=https://github.com/antmicro/fmc-sata-adapter>GithHub</a>.</p>
<p><img src=./running-open-source-sata-hardware.jpg alt="Open source SATA hardware setup"></p>
<h2 id=fpga-gateware-and-system-block-diagram>FPGA gateware and system block diagram</h2>
<p>The FPGA design is generated with the LiteX SoC builder and the main components that we used are:</p>
<ul>
<li>The VexRiscV RISC-V CPU</li>
<li>The LiteDRAM controller to communicate with the DDR Memory</li>
<li>The LiteSATA core to communicate with the SSD module on the custom expansion board</li>
<li>a UART controller to be able to control the system from the host</li>
</ul>
<p>Moreover, the software running in the SoC includes a simple BIOS that can perform SATA initialization and basic read and write operations of the sectors in the SSD drive.</p>
<p><img src=Running-open-source-SATA-diagram.svg alt="Running open source SATA diagram"></p>
<h2 id=open-source-toolchain>Open source toolchain</h2>
<p>The SATA setup proves that high speed protocols can be enabled on mainstream FPGAs such as Xilinx 7-series with an open source toolchain, with Yosys for synthesis and VPR for place and route. The LiteSATA IP core makes use of so-called GTP hard blocks, and in fact one of the main challenges we dealt with here was enabling these hard blocks in the Artix-7 architecture definition to get an end-to-end open source toolchain.</p>
<p>Other than enabling more coverage of popular FPGAs, much of our current FPGA toolchain effort goes into increasing the interoperability of tools like VPR and nextpnr as well as their proprietary counterparts to enable a more collaborative ecosystem which would enable the community – including universities, commercial companies, FPGA vendors and individual developers – to tackle the ambitious goal of open source FPGAs together.</p>
<p>For more information on the FPGA interchange and how much value it brings to the open source FPGA tooling refer to the dedicated Antmicro <a href=https://antmicro.com/blog/2021/09/symbiflow-fpga-interchange-format/>blog note</a>. In the future, once that work is at a more advanced stage, LiteSATA will be one of the first example designs to be tested with the FPGA interchange-enabled tools.</p>
<h2 id=building-and-running-the-setup>Building and running the setup</h2>
<p>The FPGA SATA design is available in the <a href=https://github.com/SymbiFlow/symbiflow-examples/tree/master/xc7/litex_sata_demo>symbiflow-examples</a> repository and can be built with the open toolchain, and run on the hardware setup described above.</p>
<p>After following the <a href=https://symbiflow-examples.readthedocs.io/en/latest/getting-symbiflow.html>instructions to install the toolchain</a> and <a href=https://symbiflow-examples.readthedocs.io/en/latest/building-examples.html#building-examples--page-root>preparing the environment</a>, run the following to build the LiteX SATA design:</p>
<pre tabindex=0><code>cd xc7
make TARGET=”nexys_video” -C litex_sata_demo
</code></pre><p>When the bitstream is generated, you can find it in the build directory under <code>litex_sata_demo/build/nexys_video</code>.</p>
<p>To load the bitstream on the Nexys Video board you can use the <a href=https://github.com/trabucayre/openFPGALoader>OpenFPGALoader tool</a>, which has support for the board.</p>
<p>Once the bitstream is loaded on the FPGA, you can access the BIOS console through the UART connected to your host system and run the following (note that X depends on the assigned USB device):</p>
<pre tabindex=0><code>picocom --baud 115200 /dev/ttyUSBX
</code></pre><p>When the LiteX BIOS gives you control, you need to perform the SATA initialization before being able to read and write sectors on the drive. See the output below:</p>
<p><img src=litesata-console.png alt="Running LiteSATA with SymbiFlow in console"></p>
<h2 id=future-goals>Future goals</h2>
<p>The work on enabling the SATA protocol in a fully open source flow was one of the steps on the way towards supporting PCIe in the toolchain which will unlock even more advanced use cases. PCIe can be used for a variety of purposes, such as connecting external graphic cards or accelerators to an FPGA design, and generally enable even faster transmission rates from and to the FPGA chip.</p>
</div>
</article>
</div>
</div>
</div>
</section>
<section class="blog-related position-relative">
<div class=container>
<div class=row>
<div class=col-md-12>
<div class=blog-section>
<h2 class=blog-section-title>Recent News</h2>
</div>
</div>
</div>
<div class=row>
<div class="col-lg-4 col-md-6">
<article class=blog-post>
<div class=blog-post-thumb>
<a href=/preview/42/news/chips-alliance-welcomes-the-caliptra-open-source-root-of-trust-project/>
<img src=https://chipsalliance.org/preview/42/news/chips-alliance-welcomes-the-caliptra-open-source-root-of-trust-project/share.png alt=blog-thumb loading=lazy>
</a>
</div>
<div class=blog-post-content>
<div class=blog-post-tag>
<a href=https://chipsalliance.org/preview/42/categories/announcements>Announcements</a>
</div>
<div class=blog-post-date>
December 13, 2022
</div>
<div class=blog-post-title>
<a href=/preview/42/news/chips-alliance-welcomes-the-caliptra-open-source-root-of-trust-project/>CHIPS Alliance Welcomes the Caliptra Open Source Root of Trust Project</a>
</div>
</div>
</article>
</div>
<div class="col-lg-4 col-md-6">
<article class=blog-post>
<div class=blog-post-thumb>
<a href=/preview/42/news/joint-analog-workgroup-mos-ak-panel-session/>
<img src=https://chipsalliance.org/preview/42/news/joint-analog-workgroup-mos-ak-panel-session/share.png alt=blog-thumb loading=lazy>
</a>
</div>
<div class=blog-post-content>
<div class=blog-post-tag>
<a href=https://chipsalliance.org/preview/42/categories/blog>Blog</a>
</div>
<div class=blog-post-date>
December 5, 2022
</div>
<div class=blog-post-title>
<a href=/preview/42/news/joint-analog-workgroup-mos-ak-panel-session/>Joint Analog Workgroup / MOS-AK Panel Session</a>
</div>
</div>
</article>
</div>
<div class="col-lg-4 col-md-6">
<article class=blog-post>
<div class=blog-post-thumb>
<a href=/preview/42/news/chips-alliance-fall-2022-technology-update-december-15/>
<img src=https://chipsalliance.org/preview/42/news/chips-alliance-fall-2022-technology-update-december-15/share.png alt=blog-thumb loading=lazy>
</a>
</div>
<div class=blog-post-content>
<div class=blog-post-tag>
<a href=https://chipsalliance.org/preview/42/categories/announcements>Announcements</a>
</div>
<div class=blog-post-date>
December 1, 2022
</div>
<div class=blog-post-title>
<a href=/preview/42/news/chips-alliance-fall-2022-technology-update-december-15/>CHIPS Alliance Fall 2022 Technology Update December 15</a>
</div>
</div>
</article>
</div>
</div>
</div>
</section>
<footer class="footer pt-xxl-19 pt-8 pb-sm-7 pb-5" id=footer>
<div class=container-fluid>
<div class=footer-wrapper>
<div class=row>
<div class="col-12 col-lg-4 me-auto order-2 order-lg-1">
<div class="footer-logo mt-7 mt-md-0 mb-5">
<a href=/preview/42/>
<img src=/preview/42/images/chips-logo-white.svg alt=logo>
</a>
</div>
<div class=social-icon>
<ul class=list-unstyled>
<li>
<a href=https://twitter.com/chipsalliance> <i class=ph-twitter-logo></i> </a>
</li>
<li>
<a href=https://github.com/chipsalliance> <i class=ph-github-logo></i> </a>
</li>
<li>
<a href=https://www.linkedin.com/company/chipsalliance/> <i class=ph-linkedin-logo></i> </a>
</li>
</ul>
</div>
<div class="footer-logo mt-7 mt-md-0">
<p>
© Copyright <span>2023</span> CHIPS Alliance
The Linux Foundation® . All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href=https://www.linuxfoundation.org/trademark-usage>Trademark Usage</a> page. Linux is a registered trademark of Linus Torvalds. <a href=http://www.linuxfoundation.org/privacy>Privacy Policy</a> and <a href=http://www.linuxfoundation.org/terms>Terms of Use</a>.
</p>
</div>
</div>
<div class="col-6 col-md-4 col-sm-4 col-lg-2 order-1">
<div class=footer-widget>
<h3>About</h3>
<ul class=list-unstyled>
<li>
<a href=/preview/42/about/who-we-are/>Who We Are</a>
</li>
<li>
<a href=/preview/42/about/members/>Members</a>
</li>
<li>
<a href=/preview/42/about/governance/>Governance</a>
</li>
<li>
<a href=/preview/42/about/faq/>FAQ</a>
</li>
<li>
<a href=/preview/42/about/contact/>Contact</a>
</li>
</ul>
</div>
</div>
<div class="col-6 col-md-4 col-sm-4 col-lg-2 order-1">
<div class=footer-widget>
<h3>Community</h3>
<ul class=list-unstyled>
<li>
<a href=/preview/42/projects/>Projects</a>
</li>
<li>
<a href=/preview/42/getting-started/>Getting Started</a>
</li>
<li>
<a href=/preview/42/events/>Events</a>
</li>
<li>
<a href=/preview/42/workgroups/>Workgroups</a>
</li>
</ul>
</div>
</div>
<div class="col-6 col-md-4 col-sm-4 col-lg-2 order-1">
<div class=footer-widget>
<h3>News</h3>
<ul class=list-unstyled>
<li>
<a href=/preview/42/categories/announcements/>Announcements</a>
</li>
<li>
<a href=/preview/42/categories/blog/>Blog</a>
</li>
<li>
<a href=/preview/42/categories/reports/>Reports</a>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</footer>
<script src=/preview/42/vendor/jQuery/jquery.min.js></script>
<script src=/preview/42/vendor/bootstrap/bootstrap.bundle.min.js></script>
<script src=/preview/42/vendor/counter-up/countup.js></script>
<script src=/preview/42/vendor/magnific-popup/magnific-popup.min.js></script>
<script src=/preview/42/js/script.js></script>
</body>
</html>